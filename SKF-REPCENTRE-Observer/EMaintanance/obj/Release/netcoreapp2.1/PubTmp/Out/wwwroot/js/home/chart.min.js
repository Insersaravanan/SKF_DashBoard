app.requires.push("commonMethods");app.controller("skfCtrl",function($scope,$filter,$http,globalInfoFactory,utility,clientFactory,locationFactory){$scope.tableValues=!1;$scope.location=sessionStorage.getItem("location");$scope.loadData=function(){$scope.tableValues=!0;$http.get("/Home/GetDashboardInfo?clientID="+$scope.clientId+"&locationId="+$scope.location).then(function(response){response.data&&($scope.dashInfo=response.data)});$http.get("/Home/DbRevenueCost?clientID="+$scope.clientId+"&locationId="+$scope.location).then(function(response){if(response.data){var _=response.data;$scope.dbRevenue=_;$scope.rtotal=_.RiskAvoidanceCost+_.TrueSavingsCost+_.EnergySavingCost+_.TechUpgradeCost+_.UnexpectedBreakdownCost}});$http.get("/Home/DbSavingHours?clientID="+$scope.clientId+"&locationId="+$scope.location).then(function(response){if(response.data){var _data=response.data;$scope.dbSaving=_data;$scope.stotal=utility.getFloat(_data.RiskAvoidanceHours,4)+utility.getFloat(_data.TrueSavingsHours,4)+utility.getFloat(_data.EnergySavingHours,4)+utility.getFloat(_data.TechUpgradeHours,4)+utility.getFloat(_data.UnexpectedBreakdownHours,4)}})};$scope.$watch(function(){return clientFactory.getclientId()},function(newValue,oldValue){newValue!=oldValue&&newValue&&($scope.clientId=newValue,$scope.loadData())});$scope.$watch(function(){return locationFactory.getlocationId()},function(newValue,oldValue){newValue!=oldValue&&newValue&&($scope.location=newValue,$scope.loadData())});globalInfoFactory.async().then(function(gInfo){$scope.defaultClient=sessionStorage.getItem("clientId");angular.forEach(gInfo,function(val){var _cmp=$scope.defaultClient?$scope.defaultClient==val.companyname:val.CompId==val.DefaultClientId,_row;_cmp&&(_row=val,_row&&($scope.clientId=_row.companyname,$scope.loadData()))})})});