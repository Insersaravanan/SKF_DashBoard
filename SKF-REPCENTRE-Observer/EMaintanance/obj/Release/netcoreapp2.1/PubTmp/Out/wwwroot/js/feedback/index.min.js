app.requires.push("commonMethods","ngTouch","ui.grid","ui.grid.selection","ui.grid.resizeColumns","ui.grid.edit","ui.grid.cellNav","ui.grid.pinning","ui.grid.exporter");app.controller("skfCtrl",function($scope,$filter,$timeout,$uibModal,uiGridConstants,$http,languageFactory){$scope.formatters={};$scope.columns=[{name:"sno",displayName:"#",width:"4%",minWidth:50,enableFiltering:!1,enableSorting:!1,cellTemplate:'<div class="ui-grid-cell-contents">{{grid.renderContainers.body.visibleRowCache.indexOf(row) + 1}}<\/div>'},{name:"id",displayName:"Id",enableColumnResizing:!0,width:"4%",minWidth:15},{name:'fields["System.WorkItemType"]',displayName:"Type",enableColumnResizing:!0,width:"5%",minWidth:30,cellTemplate:'<div class="ui-grid-cell-contents"><p tooltip-append-to-body="true" uib-tooltip="{{row.entity.fields[\'System.WorkItemType\']}}" tooltip-class="customClass">{{row.entity.fields["System.WorkItemType"]}} <\/p><\/div>'},{name:'fields["System.Title"]',displayName:"Title",enableColumnResizing:!0,width:"20%",minWidth:150,aggregationHideLabel:!1,aggregationType:uiGridConstants.aggregationTypes.count,footerCellTemplate:'<div class="ui-grid-cell-contents" >Total Count: {{col.getAggregationValue() | number:0 }}<\/div>',cellTemplate:'<div class="ui-grid-cell-contents"><p tooltip-append-to-body="true" uib-tooltip="{{row.entity.fields[\'System.Title\']}}" tooltip-class="customClass">{{row.entity.fields["System.Title"]}} <\/p><\/div>'},{name:'fields["System.Tags"]',displayName:"Tags",enableColumnResizing:!0,width:"15%",minWidth:100,cellTemplate:'<div class="ui-grid-cell-contents"><p tooltip-append-to-body="true" uib-tooltip="{{row.entity.fields[\'System.Tags\']}}" tooltip-class="customClass">{{row.entity.fields["System.Tags"]}} <\/p><\/div>'},{name:'fields["System.State"]',displayName:"Status",enableColumnResizing:!0,width:"6%",minWidth:20,cellTemplate:'<div class="ui-grid-cell-contents"><p tooltip-append-to-body="true" uib-tooltip="{{row.entity.fields[\'System.State\']}}" tooltip-class="customClass">{{row.entity.fields["System.State"]}} <\/p><\/div>'},{name:'fields["System.CreatedDate"]',displayName:"Created On",enableColumnResizing:!0,width:"14%",minWidth:100,cellFilter:'date:"medium"'},{name:'fields["System.Description"]',displayName:"Descriptions",enableColumnResizing:!0,width:"27%",minWidth:200,cellTemplate:'<div class="ui-grid-cell-contents"><p tooltip-append-to-body="true" uib-tooltip="{{row.entity.fields[\'System.Description\']}}" tooltip-class="customClass">{{row.entity.fields["System.Description"]}}<\/p><\/div>'},{name:"Action",enableFiltering:!1,enableSorting:!1,cellTemplate:'<div class="ui-grid-cell-contents"><a ng-click="grid.appScope.editRow(row.entity)" <i class="fa fa-pencil-square-o icon-space-before" tooltip-append-to-body="true" uib-tooltip="Edit" tooltip-class="customClass"><\/i><\/a><\/div>',width:"4%",minWidth:50}];$scope.editRow=function(row){var modalInstance=$uibModal.open({templateUrl:"skfFeedbackModal.html",controller:"skfFeedbackModalCtrl",size:"lg",backdropClass:"feedback-modal-wrapper",windowTopClass:"feedback-modal-wrapper",backdrop:"static",keyboard:!1,resolve:{params:{taskId:row.id}}});modalInstance.result.then(function(){},function(){})};$scope.gridOpts={columnDefs:$scope.columns,enableFiltering:!0,enablePinning:!0,enableColumnResizing:!0,showColumnFooter:!0,enableRowSelection:!0,enableSorting:!0,onRegisterApi:function(gridApi){$scope.gridApi=gridApi;$scope.gridApi.core.refresh()},enableGridMenu:!0,enableSelectAll:!1,exporterMenuPdf:!1,exporterMenuCsv:!1,exporterExcelFilename:"EMaintenance_Task.xlsx",exporterExcelSheetName:"EMaintenance_Task",exporterExcelCustomFormatters:function(grid,workbook,docDefinition){var stylesheet=workbook.getStyleSheet(),stdStyle=stylesheet.createFontStyle({size:9,fontName:"Calibri"}),boldStyle=stylesheet.createFontStyle({size:9,fontName:"Calibri",bold:!0}),aFormatDefn={font:boldStyle.id,alignment:{wrapText:!0}},formatter=stylesheet.createFormat(aFormatDefn),dateFormatter,singleDefn;return $scope.formatters.bold=formatter,dateFormatter=stylesheet.createSimpleFormatter("date"),$scope.formatters.date=dateFormatter,aFormatDefn={font:stdStyle.id,fill:{type:"pattern",patternType:"solid",fgColor:"FFFFC7CE"},alignment:{wrapText:!0}},singleDefn={font:stdStyle.id,format:"#,##0.0"},formatter=stylesheet.createFormat(aFormatDefn),$scope.formatters.red=formatter,Object.assign(docDefinition.styles,$scope.formatters),docDefinition},exporterExcelHeader:function(grid,workbook,sheet){var stylesheet=workbook.getStyleSheet(),formatterId=stylesheet.createFormat({font:{size:11,fontName:"Calibri",bold:!0},alignment:{wrapText:!0}}),cols;sheet.mergeCells("B1","C1");cols=[];cols.push({value:""});cols.push({value:"SKF",metadata:{style:formatterId.id}});sheet.data.push(cols)},exporterFieldFormatCallback:function(grid,row,gridCol,cellValue){var formatterId=null;return gridCol.field==="name"&&cellValue&&cellValue.startsWith("W")&&(formatterId=$scope.formatters.red.id),gridCol.field==="updatedDate"&&(formatterId=$scope.formatters.date.id),formatterId?{metadata:{style:formatterId}}:null},exporterColumnScaleFactor:4.5,exporterFieldApplyFilters:!0};$scope.loadData=function(){$scope.gridOpts.data=[];$http.get("/Feedback/GetWorkItems").then(function(response){response.data&&($scope.gridOpts.data=response.data)})};$scope.$watch(function(){return languageFactory.getLanguage()},function(newValue,oldValue){newValue!=oldValue&&newValue&&($scope.language=newValue,$scope.loadData())})});