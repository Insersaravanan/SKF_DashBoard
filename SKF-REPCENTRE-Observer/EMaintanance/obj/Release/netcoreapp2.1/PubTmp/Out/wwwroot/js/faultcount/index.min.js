app.requires.push("commonMethods","ngTouch","ui.grid","ui.grid.selection","ui.grid.resizeColumns","ui.grid.edit","ui.grid.cellNav","ui.grid.pinning","ui.grid.exporter");app.controller("skfCtrl",function($scope,$filter,$timeout,uiGridConstants,$http,languageFactory,alertFactory,clientFactory){$scope.startIndex=1;$scope.isCreate=!1;$scope.isSearch=!0;$scope.isEdit=!1;$scope.isclear=!0;$scope.readOnlyPage=!1;$scope.S_active="All";$scope.formatters={};$scope.selectClient=function(){var clientInfo=sessionStorage.getItem("clientInfo"),_client;clientFactory.setClient(clientInfo);clientInfo==null?sessionStorage.setItem("isClientSite","yes"):clientInfo&&clientInfo!="undefined"&&(_client=JSON.parse(clientInfo),$scope.ClientSiteId=_client.ClientSiteId)};var _columns=[{name:"sno",displayName:"#",width:"4%",minWidth:50,enableFiltering:!1,enableSorting:!1,cellTemplate:'<div class="ui-grid-cell-contents">{{grid.renderContainers.body.visibleRowCache.indexOf(row) + 1}}<\/div>'},{name:"ClientName",displayName:"Client Name",enableColumnResizing:!0,width:"25%",minWidth:150,aggregationHideLabel:!1,aggregationType:uiGridConstants.aggregationTypes.count,footerCellTemplate:'<div class="ui-grid-cell-contents" >Total Count: {{col.getAggregationValue() | number:0 }}<\/div>'},{name:"PlantName",displayName:"Plant Name",width:"25%",minWidth:150},{name:"MachineName",displayName:"Machine Name",width:"25%",minWidth:150},{name:"FaultCount",displayName:"Fault Code",width:"20%",minWidth:150},];$scope.columns=angular.copy(_columns);$scope.loadData=function(){$http.get("/dashboard/GetFaultReportDetail?ClientSiteId="+$scope.ClientSiteId).then(function(response){$scope.gridOpts.data=response.data})};$scope.$watch(function(){return languageFactory.getLanguage()},function(newValue,oldValue){newValue!=oldValue&&newValue&&($scope.language=newValue,$scope.selectClient(),$scope.loadData())});$scope.gridOpts={columnDefs:$scope.columns,enableFiltering:!0,enablePinning:!0,enableColumnResizing:!0,showColumnFooter:!0,enableRowSelection:!0,enableSorting:!0,onRegisterApi:function(gridApi){$scope.gridApi=gridApi;$scope.gridApi.core.refresh();var col=$scope.columns;$scope.gridApi.grid.clearAllFilters=function(){$scope.gridOpts.columnDefs=[];$timeout(function(){$scope.gridOpts.columnDefs=angular.copy(_columns)},2)}}}});