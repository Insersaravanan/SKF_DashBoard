app.requires.push("textAngular","commonMethods","ngTouch","ui.grid","ui.grid.selection","ui.grid.resizeColumns","ui.grid.edit","ui.grid.cellNav","ui.grid.pinning","ui.grid.exporter");app.controller("skfCtrl",function($scope,$filter,uiGridConstants,$http,alertFactory){$scope.startIndex=1;$scope.isEdit=!1;$scope.readOnlyPage=!1;$scope.formatters={};$scope.columns=[{name:"sno",displayName:"#",width:"4%",minWidth:50,enableFiltering:!1,enableSorting:!1,cellTemplate:'<div class="ui-grid-cell-contents">{{grid.renderContainers.body.visibleRowCache.indexOf(row) + 1}}<\/div>'},{name:"TypeCode",displayName:"Type Code",enableColumnResizing:!0,width:"20%",minWidth:150,aggregationHideLabel:!1,aggregationType:uiGridConstants.aggregationTypes.count,footerCellTemplate:'<div class="ui-grid-cell-contents" >Total Count: {{col.getAggregationValue() | number:0 }}<\/div>'},{name:"TypeName",displayName:"Type Name",enableColumnResizing:!0,width:"30%",minWidth:150},{name:"Descriptions",displayName:"Descriptions",enableColumnResizing:!0,width:"30%",minWidth:200},{name:"Active",displayName:"Status",cellTemplate:'<div> {{ row.entity.Active == "Y" ? "&nbsp;Active" : "&nbsp;Inactive" }}<\/div>',cellClass:function(grid,row,col){return grid.getCellValue(row,col)==="Y"?"green":grid.getCellValue(row,col)==="N"?"red":void 0},filter:{type:uiGridConstants.filter.SELECT,selectOptions:[{value:"Y",label:"Active"},{value:"N",label:"Inactive"}]},width:"9%",minWidth:80},{name:"Action",enableFiltering:!1,enableSorting:!1,cellTemplate:'<div class="ui-grid-cell-contents"><a ng-click="grid.appScope.editRow(row.entity) || grid.appScope.toggleCreate()" <i class="fa fa-pencil-square-o icon-space-before" tooltip-append-to-body="true" uib-tooltip="Edit Cms" tooltip-class="customClass"><\/i><\/a><\/div>',width:"7%",minWidth:80}];$scope.editRow=function(row){$scope.isEdit=!0;$scope.clearModal();$scope.Cmssetup=row};$scope.resetForm=function(){setTimeout(function(){for(var elements=document.getElementsByName("userForm")[0].querySelectorAll(".has-error"),i=0;i<elements.length;i++)elements[i].className=elements[i].className.replace(/\has-error\b/g,"")},500)};$scope.clearModal=function(){$scope.readOnlyPage=!1;$scope.isProcess=!1;$scope.Cmssetup={Cmsid:0,TypeCode:null,TypeName:null,Descriptions:null,TypeText:null,TypeOrder:null,Active:null,CreatedBy:null,Createdon:null};$scope.resetForm()};$scope.clearOut=function(){$scope.isEdit=!1;$scope.clearModal()};$scope.clearOut();$scope.gridOpts={columnDefs:$scope.columns,enableFiltering:!0,enablePinning:!0,enableColumnResizing:!0,showColumnFooter:!0,enableRowSelection:!0,enableSorting:!0,onRegisterApi:function(gridApi){$scope.gridApi=gridApi}};$scope.loadData=function(){$http.get("/Pagesetup/GetList").then(function(response){$scope.gridOpts.data=response.data;angular.forEach($scope.gridOpts.data,function(val,i){val.sno=i+1})})};$scope.loadData();$scope.saveCMS=function(){if($scope.userForm.$valid&&!$scope.isProcess&&!$scope.readOnlyPage){$scope.isProcess=!0;$http.post("/PageSetup/Create",JSON.stringify($scope.Cmssetup)).then(function(response){response.data&&(response.data.toString().indexOf("<!DOCTYPE html>")>=0?alertFactory.setMessage({type:"warning",msg:"User not a privileged to perform this Action. Please Contact your Admin.."}):($scope.languageId=response.data,alertFactory.setMessage({msg:"Data saved Successfully."}),$scope.clearOut(),$scope.loadData()));$scope.isProcess=!1},function(response){$scope.isProcess=!1;response.data.message&&alertFactory.setMessage({type:"warning",msg:String(response.data.message),exc:String(response.data.exception)})})}};$scope.updateCMS=function(){if($scope.userForm.$valid&&!$scope.isProcess&&!$scope.readOnlyPage){$scope.isProcess=!0;$http.post("/PageSetup/Update",JSON.stringify($scope.Cmssetup)).then(function(response){response.data&&(response.data.toString().indexOf("<!DOCTYPE html>")>=0?alertFactory.setMessage({type:"warning",msg:"User not a privileged to perform this Action. Please Contact your Admin.."}):(alertFactory.setMessage({msg:"Data updated Successfully."}),$scope.clearOut(),$scope.loadData()));$scope.isProcess=!1},function(response){$scope.isProcess=!1;response.data.message&&alertFactory.setMessage({type:"warning",msg:String(response.data.message),exc:String(response.data.exception)})})}}});